<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://pclucas14.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://pclucas14.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-10-15T00:49:00+00:00</updated><id>https://pclucas14.github.io/feed.xml</id><title type="html">blank</title><subtitle>Theme from [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">EWC derivation</title><link href="https://pclucas14.github.io/math/2020/07/01/ewc.html" rel="alternate" type="text/html" title="EWC derivation"/><published>2020-07-01T15:12:00+00:00</published><updated>2020-07-01T15:12:00+00:00</updated><id>https://pclucas14.github.io/math/2020/07/01/ewc</id><content type="html" xml:base="https://pclucas14.github.io/math/2020/07/01/ewc.html"><![CDATA[<p>In the original <strong>Elastic Weight Consolidation</strong> <a href="https://arxiv.org/pdf/1612.00796.pdf">paper</a>, the authors show that given a sequence of two tasks \(t_1,t_2\), one can estimate the posterior probability of the parameters \(\theta\) <strong>over the combined datasets</strong> even with sequential access to the data. In other words, even though the learner never sees data from \(t_1\) and \(t_2\) simultaneously (only sequentially), one can still estimate \(\log p(\theta \mid \mathcal{D}_1, \mathcal{D}_2)\).</p> <p>Specifically, they show the following result :</p> \[\begin{equation}{ \log p(\theta \mid \mathcal{D}_1, \mathcal{D}_2) = \log p(\theta \mid \mathcal{D}_1) + \log p(\mathcal{D}_2 \mid \theta) - \log p(\mathcal{D}_2). }\end{equation}\] <p>Looking at the three terms on the R.H.S, the last two terms only depend on the second dataset, and the dependance on the first task is only through \(\log p(\theta \mid \mathcal{D}_1)\), the posterior probability of the parameters over the first dataset. In other words this posterior distribution is sufficient to encapsulate all the information of the first task. So this is a cool result, i.e. continual learning reduces to learning this posterior.</p> <p>But how do we obtain this result ? Let’s go through the derivation.</p> \[\begin{align} \log p(\theta | \mathcal{D}_1, \mathcal{D}_2) &amp;= \log p(\mathcal{D}_2, \mathcal{D}_1, \theta) - \log p(\mathcal{D}_1, \mathcal{D}_2) \\ &amp;= \log p(\mathcal{D}_2 | \theta, \mathcal{D}_1) + \log p(\theta | \mathcal{D}_1) + \log p(\mathcal{D}_1) - \log p(\mathcal{D}_1, \mathcal{D}_2) \\ &amp;= \log p(\mathcal{D}_2 | \theta ) + \log p(\theta | \mathcal{D}_1) - \log p(\mathcal{D}_2|\mathcal{D}_1)), \end{align}\] <p>In the first row, we expand the definition of a conditional probability. In the second row, we do a similar step and rewrite the first term \(p(\mathcal{D}_2, \mathcal{D}_1, \theta)\) as a product of conditional probabilities. But the magic really happens in the last row, where we leverage the conditional independence of \(D_1\) and \(D_2\) given \(\theta\) to remove the tricky dependance over information from the first task.</p> <p>That’s it! Now we have an objective which can be optimized without simultaneous access to the data.</p> <h4 id="comment-1">Comment 1</h4> <p>As you can see, equations (1) and (4) don’t perfectly line up; the EWC paper makes the additional assumption that \(\mathcal{D}_1\) and \(\mathcal{D}_2\) are independent (rather than conditionally on \(\theta\)), i.e.</p> \[p(\mathcal{D}_2 | \mathcal{D}_1) = p(\mathcal{D}_2)\] <p>. My understanding is that you do not need to make this assumption, as this term does not depend on \(\theta\) anyways. If you have any thoughts on why they do this, please let me know :)</p> <h4 id="comment-2">Comment 2</h4> <p>While prior based methods like EWC are theoretically sound, in practice they are quite bad. I strongly believe this is because the assumptions we make so that computing</p> \[p(\theta | \mathcal{D}_1)\] <p>is tractable are wayy to restrictive. Maybe more flexible posterior inference is a good research direction. More on that in the next blog post!</p>]]></content><author><name></name></author><category term="math"/><category term="formatting"/><category term="math"/><summary type="html"><![CDATA[description of the EWC derivation in more detail]]></summary></entry></feed>